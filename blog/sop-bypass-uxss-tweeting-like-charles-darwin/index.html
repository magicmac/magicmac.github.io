<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="alternate icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Astro v5.16.6"><title>SOP bypass / UXSS - Tweeting like Charles Darwin (Edge)</title><meta name="description" content><link rel="canonical" href="https://www.brokenbrowser.com/blog/sop-bypass-uxss-tweeting-like-charles-darwin/"><meta property="og:title" content="SOP bypass / UXSS - Tweeting like Charles Darwin (Edge)"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://www.brokenbrowser.com/blog/sop-bypass-uxss-tweeting-like-charles-darwin/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="SOP bypass / UXSS - Tweeting like Charles Darwin (Edge)"><meta name="twitter:description" content><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><link rel="stylesheet" href="/_astro/_slug_.D8CnJWvD.css"></head> <body> <div class="container center"> <header class="header"> <div class="header__inner"> <div class="header__logo"> <a href="/"> <div class="logo">
MagicMac Labs
</div> </a> </div> <ul class="menu menu--mobile"> <li class="menu__trigger">Menu ▾</li> <li> <ul class="menu__dropdown"> <!--<li><a href={`${base}`}>Home</a></li>--> <li><a href="/browser-workshop/">Browser Workshop</a></li> <li><a href="/musings/">Musings</a></li> <li><a href="/about/">About</a></li> </ul> </li> </ul> </div> <nav class="navigation-menu"> <ul class="navigation-menu__inner menu--desktop"> <!--<li><a href={`${base}`}>Home</a></li>--> <li><a href="/browser-workshop/">Browser Workshop</a></li> <li><a href="/musings/">Musings</a></li> <li><a href="/about/">About</a></li> </ul> </nav> </header> <main class="content">  <article> <h1 class="post-title">SOP bypass / UXSS - Tweeting like Charles Darwin (Edge)</h1> <div class="post-meta"> <time> <time datetime="2017-04-24T00:00:00.000Z"> 2017-04-24 </time> </time> <span class="post-category"> :: browser-workshop</span>  </div>  <div class="post-content">  <p>Watch the <strong><a href="https://www.youtube.com/watch?v=PlxQBmLrnQA&#x26;list=PL12o0t84rBX_oDmz93NwGNgTDiWf-HfUY">2 minutes exploit video where we manually tweet as if we were Charles Darwin, and get his password</a></strong> (thanks to the default password manager of Microsoft Edge). If you are out of time, watch the <strong><a href="https://www.youtube.com/watch?v=K3Ui3JxZGnE&#x26;list=PL12o0t84rBX_oDmz93NwGNgTDiWf-HfUY">1 minute video where we do the same thing, automatically</a></strong>.</p>
<p>Charles Darwin is an example, this Microsoft Edge vulnerability <strong>allows the attacker to tweet or do anything (password anyone?) from many websites on behalf of the logged user</strong>.</p>
<p>We are going to explore yet another <strong>SOP bypass on Microsoft Edge</strong>, but in this case abusing of the data/meta tags plus the fact that domainless pages have free access to domained ones.</p>
<h3 id="-update-this-bug-was-patched-on2017-06-13"><strong>[ Update: this bug was patched on 2017-06-13 ]</strong></h3>
<hr>
<h2 id="a-domainless-world-again">A domainless world, again</h2>
<p>If this is your first time here, I suggest you reading these two SOP bypasses first: <a href="../uxss-edge-domainless-world/">Adventures in a Domainless World (Edge)</a> and <a href="../uxss-ie-domainless-world/">More Adventures in a Domainless World (IE)</a>. The following post is based on the same idea, just a new technique.</p>
<p>Let’s quickly refresh on this important concept: <strong>about:blank pages have always the domain of their referrer</strong>, meaning that an about:blank from a twitter’s iframe can’t access to a google’s blank. Even if the address matches between them (about:blank), the document.domain is different.</p>
<p>In the past, we were able to create about:blanks without domains, or <strong>domainless about:blanks</strong>. Those ones have the power to access every about:blank regardless of its domain. For example, let’s say we have a domainless blank on the main page rendering an iframe pointing to twitter and another one to google. Those iframes have blank sub-iframes inside, and their domains are like their parents: twitter and google. In a case like this, the top window has access to the sub-iframes, completely bypassing the SOP.</p>
<p><img src="/images/2017/04/00-domainless-blank-chart.png" alt=""></p>
<p>The above scenario above worked perfectly well, but <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0002">Microsoft patched it</a> three months ago using a <a href="../free-ticket-to-the-intranet-zone/">very clever trick</a>: domainless blanks are not really domainless anymore, they are always set with a random GUID as their domain, like this: {53394a4f-8c04-46ab-94af-3ab86ffcfd4c}. And there’s something even more interesting (hat tip to Edge Developers): <strong>the domain will look as if it were blank/empty, but it is not</strong>. In other words, Edge will hide the GUID and return empty, but internally, it is still a GUID.</p>
<p>Let’s experiment! Open Edge with DevTools enabled (F12) and type about:blank into the address bar. This used to create a domainless blank and it still looks as if nothing has changed, but Edge is performing a trick for us. Appreciate its magic for a second please, we will have plenty of time to break the spell anyway.</p>
<p><img src="/images/2017/04/01-about-lies.png" alt=""></p>
<p>As we can see, DevTools thinks we are on an empty domain, but it is not.</p>
<h2 id="breaking-the-spell">Breaking the spell</h2>
<p>If even DevTools is being fooled, how can we see what’s really happening here? Easier than expected, just try to load anything with a relative path, or change the location of this window, or even a document.write will reveal the trick. Let’s use a <strong>location.href = 1</strong> and see what happens.</p>
<p><img src="/images/2017/04/02-real-url.png" alt=""></p>
<h2 id="top-data-uri-patched-and-flash-disabled">Top data-uri patched and Flash disabled</h2>
<p>Our <a href="../uxss-edge-domainless-world/">previous technique to create domainless blanks</a> has been patched. We were setting a data-uri on the main (top) window with the help of a Flash/GetURL. But the trick was patched and even worse, we can’t automatically run Flash anymore! In Windows Creators Update, Edge asks for permission to run Flash.</p>
<p>The PoCs from <a href="../uxss-edge-domainless-world">previous posts</a> look ugly now! Kudos to the Edge team for reducing the attack surface here.</p>
<p><img src="/images/2017/04/03-enable-flash-madam.png" alt=""></p>
<h2 id=""></h2>
<h2 id="finding-a-new-domainless-blank">Finding a new domainless blank</h2>
<p>Our data-uri trick against the top does not work anymore, so how can we overcome this? First of all, I started playing against an iframe instead of the top, because as we’ve seen in the past, Edge does not like data-uris in the main window.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:var(--astro-code-token-constant)">top</span><span style="color:var(--astro-code-foreground)">.</span><span style="color:var(--astro-code-token-constant)">location</span><span style="color:var(--astro-code-foreground)">.href </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)"> "data:text/html,SOMETHING"</span><span style="color:var(--astro-code-foreground)">; </span><span style="color:var(--astro-code-token-comment)">// Fails badly, error page</span></span></code></pre>
<p>But setting a data-uri as the location of an iframe works well. However, this is not a bug, the iframe domain is isolated from the top.</p>
<p><img src="/images/2017/04/04-setting-data-uri.png" alt=""></p>
<p>As we’ve seen in the <a href="../sop-bypass-abusing-read-protocol/">reader mode SOP bypass</a>, the data-uri “isolated” restriction is trivial to bypass (just a self document.write and we can access the parent), but we don’t want that now. Accessing the top makes no sense right now, what we want is a way to get a domainless blank. For that, we will need a triple-combo: data-meta-data. That will make Edge gently give us back what it took from us!</p>
<p>To be concrete, we will set the location of an iframe with a data uri that renders a meta refresh which redirects to another data uri. That’s the moment where you, I, and even Edge get lost :)</p>
<p><strong>Recipe to create a domainless blank:</strong></p>
<ol>
<li>Set the location of an iframe to a data-uri</li>
<li>The data-uri renders a meta refresh tag</li>
<li>The meta refresh redirects to another data-uri</li>
</ol>
<p>Let’s build a URL that converts a regular (domained) iframe into a domainless one. It is easier for me if I repeat this in my mind “data-meta-data”, because in reality, that’s all.</p>
<p><img src="/images/2017/04/05-domainless-recipe.png" alt=""></p>
<p>I know it is not as beautiful as E=mc2, but our trick could have been used to steal Einstein’s credentials, email, paypal account and even tweet something on his name. Let’s first test if what we’ve learned until this point really works. We will play with bing.com which is easy because it has an inner blank iframe and it does not use <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">XFO</a>.</p>
<h2 id="warming-up-with-bingcom">Warming up with bing.com</h2>
<p>We will create a webpage with two iframes: one with bing.com and one domainless. From the domainless we will execute code inside bing’s inner blank iframe. Bing images  is perfect for our needs. Let me open Chrome for a second and show you what I mean.</p>
<p><img src="/images/2017/04/06-bing-is-easy.png" alt=""></p>
<p>This is great. Now we will frame this page and inject code into the blank iframe with the help of our <strong>domainless data-meta-data</strong>. But there’s something that I didn’t say, bug hunter. Do you remember the naming problem that we had with nature.com in our <a href="../uxss-edge-domainless-world/">original domainless SOP</a>? If not, let me give you a very quick refresh.</p>
<p>At this point, our domainless iframe is able to access bing’s blank, but, the access mechanism is extremely important. We can’t just access the DOM straight, we must use the window.open method. In other words, if bing is in the first iframe of the main page, we won’t be able to access its inner iframe this way:</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:var(--astro-code-token-function)">alert</span><span style="color:var(--astro-code-foreground)">(top[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-foreground)">][</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-foreground)">].</span><span style="color:var(--astro-code-token-constant)">document</span><span style="color:var(--astro-code-foreground)">.cookie); </span><span style="color:var(--astro-code-token-comment)">// ACCESS DENIED</span></span></code></pre>
<p>In fact, we can’t even do this</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:var(--astro-code-foreground)">top[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-foreground)">][</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-foreground)">].</span><span style="color:var(--astro-code-token-constant)">location</span><span style="color:var(--astro-code-foreground)">.href </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)"> "javascript:alert(document.cookie)"</span><span style="color:var(--astro-code-foreground)">; </span><span style="color:var(--astro-code-token-comment)">// ACCESS DENIED</span></span></code></pre>
<p>So, how can we do it? Very easy, a window open with a javascript url <strong>and the name of the iframe</strong>. If bing’s inner iframe name were “<strong>INNER_IFRAME</strong>”, the following code would work perfectly well:</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:var(--astro-code-token-constant)">window</span><span style="color:var(--astro-code-token-function)">.open</span><span style="color:var(--astro-code-foreground)">(</span><span style="color:var(--astro-code-token-string-expression)">"javascript:alert(document.cookie)"</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> "INNER_IFRAME"</span><span style="color:var(--astro-code-foreground)">); </span><span style="color:var(--astro-code-token-comment)">// SOP BYPASSED!</span></span></code></pre>
<p>But damn it! This nested iframe in Bing doesn’t have a name! Bug hunter, don’t panic. We can either request the Bing team to set a name for us, :) or, we can keep pushing. Better to keep pushing!</p>
<h2 id="setting-an-iframe-name">Setting an iframe name</h2>
<p>We can’t set the name of an iframe that we don’t own, unless it is in the same domain as we are. We are going to render a bing iframe that has a blank one inside. The outer iframe is on the different domain, but the tag itself (the element, the object) is in our domain, so we can set any name we want.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="html"><code><span class="line"><span style="color:var(--astro-code-foreground)">&#x3C;</span><span style="color:var(--astro-code-token-string-expression)">iframe</span><span style="color:var(--astro-code-token-function)"> name</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">"ANY_NAME"</span><span style="color:var(--astro-code-token-function)"> src</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">"http://bing.com"</span><span style="color:var(--astro-code-foreground)">></span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">   &#x3C;</span><span style="color:var(--astro-code-token-string-expression)">iframe</span><span style="color:var(--astro-code-token-function)"> src</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">"about:blank"</span><span style="color:var(--astro-code-foreground)">>&#x3C;/</span><span style="color:var(--astro-code-token-string-expression)">iframe</span><span style="color:var(--astro-code-foreground)">></span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">&#x3C;/</span><span style="color:var(--astro-code-token-string-expression)">iframe</span><span style="color:var(--astro-code-foreground)">></span></span></code></pre>
<p>But the inner iframe is rendered by bing, and even if it’s blank, its domain is still bing.com. The only way to change its name is to first set its location to one that we can access, and only then change its name. Now, if we change the location of the about:blank it will be like shooting in the foot, because we need to be be bing.com so we can later access with the domainless blank.</p>
<p>Remember: our goal is to access from a domainless blank to a domained one. If we set the domain to match ours, then it makes no sense to access it! So here’s what we will do: we will set the location, change the iframe name and then, <strong>restore the location back</strong> in such a way that it will keep the original domain. Sounds complicated?</p>
<p><strong>Recipe to set the name of an x-domain-iframe:</strong></p>
<ol>
<li>Set the location of the iframe to about:blank, which changes its domain to the one that we control: cracking.com.ar</li>
<li>Change the iframe name at will.</li>
<li>Set its location again to about:blank, but this time using a meta refresh which makes its domain == its creator: bing.com in this case.</li>
</ol>
<p>That’s it. Now the inner-iframe has a name and its domain is restored to bing.com! This is code:</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="html"><code><span class="line"><span style="color:var(--astro-code-foreground)">// Sets the location of Bing's inner iframe to about:blank</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">// But now it is in our domain so we can set a name to it.</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">window[0][0].location = "about:blank";</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-foreground)">// Set the inner iframe name to "CHARLES" so we can later inject code</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">// using a window.open("javascript:[...]","CHARLES");</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">window[0][0].name = "CHARLES";</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">		</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">// Restore Bing's domain to the about:blank that we've just renamed.</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">window[0][0].document.write('&#x3C;</span><span style="color:var(--astro-code-token-string-expression)">meta</span><span style="color:var(--astro-code-token-function)"> http-equiv</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">"refresh"</span><span style="color:var(--astro-code-token-function)"> content</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">"0;url=about:blank"</span><span style="color:var(--astro-code-foreground)">>');</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">window[0][0].document.close();</span></span>
<span class="line"></span></code></pre>
<p>Let me give you the good news: we don’t really need sites with “about:blank” iframes because we can always do as we did above. In other words, it does not matter if bing’s inner iframe was about:blank on not because we ended up setting it as blank with its original domain! I don’t know how you feel bug hunter, but I feel exactly <a href="https://youtu.be/LUDEjulbqzk?t=68">like this</a>.</p>
<p>The doors are open for us! We can finally run the window.open from our data-meta-data iframe:</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:var(--astro-code-token-constant)">window</span><span style="color:var(--astro-code-token-function)">.open</span><span style="color:var(--astro-code-foreground)">(</span><span style="color:var(--astro-code-token-string-expression)">"javascript:alert(document.cookie)"</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> "CHARLES"</span><span style="color:var(--astro-code-foreground)">); </span><span style="color:var(--astro-code-token-comment)">// Fireeeeeeeeeee!!!</span></span></code></pre>
<p><img src="/images/2017/04/07-bing-likes-cookies.png" alt=""></p>
<h2 id="-video-in-youtube">[ <a href="https://youtu.be/E_6OFcTi5kQ">Video in YouTube</a> ]</h2>
<p>One important thing regarding the PoC, bug hunter: in the sample above we are using an http (insecure) connection because in https the meta refresh to data is blocked so it never redirects to the final data uri. Edge <em>incorrectly thinks</em> that the redirection is insecure. However, this can be easily bypassed by using a document.write. So instead of a data-meta-data it should be document.write(meta-data). Makes sense?</p>
<p>We are not using it in the PoC above, because when making the demo interactive (making you press buttons to run it) Edge crashes (non-exploitable ) a third of the times. So, I’ve chosen to use a guided and reliable PoC in http vs https automatic. But either way, as we will see below it does not really matter: our insecure domainless page is capable of accessing secure pages. Let’s build a real case.</p>
<h2 id="a-real-attack-stealing-charles-cookies">A real attack: Stealing Charles cookies</h2>
<p>It is the time to build an attack, bug hunter. Join me into the time machine where we can fly to the past, bringing computers and Internet to the geniuses that preceded us. Charles Darwin is thinking about how species change over time, while Alfred Wallace is having similar ideas. Charles is aware of hackers so he uses his computer in paranoid mode: he never opens a link in using the same browser window where he has his gmail, twitter, and personal documents.</p>
<p>Take a look, bug hunter. He is opening a new InPrivate window from the task bar!</p>
<p><img src="/images/2017/04/08-paranoid-charles.png" alt=""></p>
<p>He is in good mood, to the point that he opens another tab with his Twitter account, and teases Alfred Wallace about who will tweet first.</p>
<p><img src="/images/2017/04/09-charles-tweeting.png" alt=""></p>
<p>The response from Wallace came a few hours later, and it included a link with evidence supporting his claims. But remember, Charles did not trust anyone so he copied the link in order to paste it into a new window, away from the one where he had his personal data (gmail, twitter).</p>
<p><img src="/images/2017/04/09-wallace-response.png" alt=""></p>
<p>What can go wrong? Everything! Twitter has several iframes, just like most sites in the world. In fact, it has two blank iframes with names, so this should be easier than Bing! But before going back to our story :) let’s enumerate twitter’s iframes using DevTools to find a good candidate. I’m opening a different window here, nothing to do with Charles session.</p>
<p><img src="/images/2017/04/10-twitter-enumeration.png" alt=""></p>
<p>Excellent! <strong>dm-post-iframe</strong> looks good, so we have all we need to take over Charlie’s account.</p>
<p>Charles opened a new inPrivate window and loaded the URL that Wallace sent him. What he didn’t know was that browser windows, even inPrivate, can communicate with each other. So, what will happen if we execute the code below in our domainless iframe?</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:var(--astro-code-token-constant)">window</span><span style="color:var(--astro-code-token-function)">.open</span><span style="color:var(--astro-code-foreground)">(</span><span style="color:var(--astro-code-token-string-expression)">"javascript:alert(document.cookie)"</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> "dm-post-iframe"</span><span style="color:var(--astro-code-foreground)">);</span></span></code></pre>
<p>You are totally right. <strong>We have Charles Darwin cookies</strong>.</p>
<p><img src="/images/2017/04/11-charles-has-cookies.png" alt=""></p>
<p>Keep in mind that we don’t really need the InPrivate windows. The example above tries to illustrate a paranoid scenario, but normally things are even easier because people click on links without doing all the work that Charles did to prevent the attack. Also, consider that <a href="https://blog.malwarebytes.com/101/2015/02/what-is-malvertising/">attackers use malvertising</a>, deploying their bad bits inside cheap banners from popular sites. If an attacker is hosted inside a Yahoo banner and the user is logged in into her Twitter account, she will be pwned with no interactions, at all.</p>
<h2 id="tweeting-like-charles-darwin">Tweeting like Charles Darwin</h2>
<p>Let’s build a better PoC. Instead of reading his cookies, we will tweet on his name and even try to grab his password. Keep in mind that most users (like Charlie) use password managers that auto-fill their passwords. Edge password manager is no different, so, if Charles has saved his password, we will get it. It’s not hard, just force him a log out and the log-in page will be automatically loaded, with all his data (username and password) server to us in a silver player. In fact, in this case the form is hidden unless the user interacts, but Edge is filling it anyway so we don’t even have to make the form visible.</p>
<p>Before running the PoC, consider that it is <strong>your account</strong> the one that will be exposed, not Charles. Nothing is being sent to the network but if there’s somebody behind you, she will see your password in a regular alert dialog. Watch out!</p>
<h3 id="video-automatic-tweeting-1-minute"><a href="https://www.youtube.com/watch?v=K3Ui3JxZGnE&#x26;list=PL12o0t84rBX_oDmz93NwGNgTDiWf-HfUY">Video: Automatic Tweeting</a> (1 Minute)</h3>
<h3 id="video-manual-tweeting-2-minutes"><a href="https://www.youtube.com/watch?v=PlxQBmLrnQA&#x26;list=PL12o0t84rBX_oDmz93NwGNgTDiWf-HfUY">Video: Manual Tweeting</a> (2 Minutes)</h3>
<hr>
<h2 id="quick-questions-that-came-to-my-mind">Quick questions that came to my mind:</h2>
<p><strong>Can we use this in sites without about:blank iframes?</strong>  Of course! We can even do it in sites that don’t have iframes at all. Please, read this post where we <a href="../referer-spoofing-patch-bypass/">inject an iframe on a different origin</a>. Same <a href="../uxss-ie-htmlfile/">here on Internet Explorer</a>.</p>
<p><strong>Is it possible to do the same thing, in Facebook?</strong> I don’t have a facebook account, so I did not test. But a SOP bypass is capable of accessing every single domain in the planet. It could be a little bit harder to exploit, but impossible? Never. Just remember the mantra: <strong>try harder</strong>.</p>
<p><strong>Does this work in other browsers?</strong> I did not try, but obviously not. UXSS/SOP bypasses tend to be particular to each browser.</p>
<hr>
<h3 id="download-all-the-pocs"><a href="https://goo.gl/8UY2y5">Download all the PoCs</a></h3>
<p>The exploit code is easy. Please <a href="https://goo.gl/8UY2y5">get it</a> and take a look, but if you have questions, <a href="https://twitter.com/magicmac2000">ask</a>! I stop here, bug hunter, otherwise this blog will be renamed to brokenmarriage.com :) It’s late night in Buenos Aires, time to be with my wife!</p>
<p>Have a nice day!</p>
<p><a href="https://twitter.com/magicmac2000">Manuel</a></p> <div class="pagination"> <div class="pagination__title"> <span class="pagination__title-h">Read other posts</span> <hr> </div> <div class="pagination__buttons">  <a href="/blog/sop-bypass-abusing-read-protocol/" class="button inline prev">
&lt; [SOP bypass courtesy of the reading mode (Edge)]
</a> <span>::</span> <a href="/blog/sop-bypass-uxss-stealing-credentials-pretty-fast/" class="button inline next">
[SOP bypass / UXSS - Stealing Credentials Pretty Fast (Edge)] &gt;
</a> </div> </div>  </div> </article> <script type="module">document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("pre.astro-code").forEach(t=>{const n=document.createElement("div");n.className="highlight",t.parentNode?.insertBefore(n,t),n.appendChild(t);const a=t.getAttribute("data-language")||"text",o=document.createElement("div");if(o.className="code-title",o.textContent=a,navigator.clipboard){const e=document.createElement("button");e.className="copy-button",e.textContent="Copy",e.addEventListener("click",async()=>{const c=t.textContent||"";try{await navigator.clipboard.writeText(c),e.textContent="Copied",setTimeout(()=>{e.textContent="Copy"},1e3)}catch(r){console.error("Failed to copy:",r)}}),o.appendChild(e)}n.insertBefore(o,t)})});</script>  <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>  </main> <footer class="footer"> <div class="footer__inner"> <div class="copyright"> <span>© 2026 MagicMac Labs</span> </div> </div> </footer> </div> <script type="module">(()=>{const s=document.querySelector(".container"),o=document.querySelectorAll(".menu");document.body.addEventListener("click",()=>{o.forEach(e=>{e.classList.contains("open")&&e.classList.remove("open")})}),window.addEventListener("resize",()=>{o.forEach(e=>{e.classList.remove("open")})}),o.forEach(e=>{const i=e.querySelector(".menu__trigger"),t=e.querySelector(".menu__dropdown");i&&t&&(i.addEventListener("click",n=>{n.stopPropagation(),e.classList.contains("open")?e.classList.remove("open"):(o.forEach(c=>c.classList.remove("open")),e.classList.add("open")),s&&t.getBoundingClientRect().right>s.getBoundingClientRect().right&&(t.style.left="auto",t.style.right="0")}),t.addEventListener("click",n=>n.stopPropagation()))})})();</script> </body> </html> 